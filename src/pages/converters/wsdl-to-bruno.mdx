import { Callout } from 'nextra/components'
import { Tabs } from 'nextra/components'

# Convert WSDL to Bruno Collection

Bruno supports importing WSDL (Web Services Description Language) files to automatically generate SOAP API collections. This feature is particularly useful when working with legacy SOAP-based web services, as it eliminates the need for manual configuration of SOAP requests.

<Callout type="info">
  WSDL import is available in Bruno v2.14.0 and later versions.
</Callout>

## What Gets Generated

When you import a WSDL file, Bruno automatically:

- **Parses the WSDL structure** and extracts all available service operations
- **Creates a structured collection** with operations organized as individual `.bru` requests
- **Generates SOAP envelope templates** for each operation based on the XML schema definitions
- **Pre-configures required headers** including `Content-Type: text/xml` and `SOAPAction`
- **Includes XML schema documentation** as comments within the request body

## Import WSDL via UI

### Step 1: Access Import Collection

1. Click on the three-dot menu next to any collection in the sidebar
2. Select **Import Collection** from the dropdown menu


### Step 2: Choose WSDL Option

1. In the Import Collection dialog, select the **WSDL** option
2. You can either:
   - Click the upload area to browse for a local `.wsdl` file
   - Drag and drop a WSDL file directly into the dialog


### Step 3: Import and Review

1. After selecting your WSDL file, Bruno will parse it and generate the collection
2. A new folder will be created containing all the SOAP operations
3. Each operation will be a separate request with a pre-configured SOAP envelope

<Callout type="info">
  Bruno automatically validates the WSDL structure during import. If there are any issues, you'll receive clear error messages.
</Callout>

## Import WSDL via CLI

You can also import WSDL files using the Bruno CLI, which is useful for automation and CI/CD workflows.

<Tabs items={['Local File', 'URL']}>
  <Tabs.Tab>
  ### Import from Local File

  ```bash
  bru import wsdl --wsdl path/to/service.wsdl --output ./my-collection
  ```

  **Parameters:**
  - `--wsdl`: Path to your local WSDL file
  - `--output`: Directory where the Bruno collection will be created

  </Tabs.Tab>
  <Tabs.Tab>
  ### Import from URL

  ```bash
  bru import wsdl --wsdl https://example.com/service?wsdl --output ./my-collection
  ```

  **Parameters:**
  - `--wsdl`: URL of the WSDL endpoint
  - `--output`: Directory where the Bruno collection will be created

  <Callout type="warning">
    When importing from a URL, ensure the WSDL endpoint is publicly accessible or that you have proper network access.
  </Callout>
  </Tabs.Tab>
</Tabs>

## Programmatic Conversion

For advanced use cases, you can use the `@usebruno/converters` package to programmatically convert WSDL to Bruno collections.

### Installation

```bash
npm install @usebruno/converters
```

### Basic Usage

```javascript
const { wsdlToBruno } = require('@usebruno/converters');
const { readFile, writeFile } = require('fs/promises');

async function convertWsdlToBruno(wsdlFile, outputFile) {
  try {
    // Read the WSDL file
    const wsdlContent = await readFile(wsdlFile, 'utf8');
    
    // Convert to Bruno collection
    const brunoCollection = await wsdlToBruno(wsdlContent);
    
    // Write the output
    await writeFile(outputFile, JSON.stringify(brunoCollection, null, 2));
    console.log('WSDL conversion successful!');
  } catch (error) {
    console.error('Error during WSDL conversion:', error.message);
  }
}

// Convert WSDL to Bruno
convertWsdlToBruno('path/to/service.wsdl', 'path/to/bruno-collection.json');
```

## Generated Request Structure

Each SOAP operation in the imported collection will have the following structure:

### Request Headers

```
Content-Type: text/xml; charset=utf-8
SOAPAction: "http://example.com/ServiceName/OperationName"
```

### Request Body

```xml
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Header>
    <!-- Optional header elements -->
  </soap:Header>
  <soap:Body>
    <OperationName xmlns="http://example.com/namespace">
      <!-- Parameters based on WSDL schema -->
      <Parameter1>value</Parameter1>
      <Parameter2>value</Parameter2>
    </OperationName>
  </soap:Body>
</soap:Envelope>
```

## Error Handling

Bruno provides clear error messages for common WSDL import issues:

### Invalid WSDL Structure

```
Error: Invalid WSDL format - Missing required definitions
```

**Solution:** Ensure your WSDL file is well-formed and contains all required elements (definitions, types, messages, portType, binding, service).

### Unsupported WSDL Features

```
Error: WSDL feature not supported - [feature name]
```

**Solution:** Some advanced WSDL features may not be fully supported. Consider simplifying the WSDL or creating requests manually.

### Network Errors (URL Import)

```
Error: Failed to fetch WSDL from URL
```

**Solution:** Check your network connection, verify the URL is correct, and ensure the WSDL endpoint is accessible.

## Best Practices

### 1. Review Generated Requests

After importing, review each generated request to:
- Verify the SOAP envelope structure matches your service requirements
- Add authentication headers if needed (API keys, tokens, etc.)
- Customize parameter values in the request body

### 2. Use Environments for Variables

For dynamic values like endpoints or authentication tokens:

```xml
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Header>
    <AuthToken>{{apiToken}}</AuthToken>
  </soap:Header>
  <soap:Body>
    <GetUser xmlns="{{serviceNamespace}}">
      <UserId>{{userId}}</UserId>
    </GetUser>
  </soap:Body>
</soap:Envelope>
```

### 3. Organize Large WSDL Imports

For WSDLs with many operations:
- Use folders to group related operations
- Add descriptive names to requests
- Document any customizations in request notes

### 4. Handle Complex Types

If your WSDL includes complex types or nested schemas:
- Check the generated XML structure carefully
- Refer to the WSDL schema documentation for type definitions
- Use Bruno's XML validation to ensure proper formatting

## Limitations

### Current Limitations

1. **SOAP Version**: Currently supports SOAP 1.1 and 1.2 envelopes
2. **WS-Security**: Basic authentication is supported; advanced WS-Security features may require manual configuration
3. **Attachments**: SOAP with Attachments (SwA) and MTOM are not automatically configured
4. **Complex Schemas**: Very complex XML schemas may require manual adjustment

### Workarounds

For features not fully supported:
- Manually edit the generated SOAP envelope in the request body
- Add required headers in the Headers tab
- Use pre-request scripts for dynamic SOAP header generation

## Example: Complete WSDL Import Workflow

Here's a complete example of importing and using a WSDL file:

### 1. Import the WSDL

```bash
bru import wsdl --wsdl https://api.example.com/calculator.wsdl --output ./calculator-collection
```

### 2. Generated Collection Structure

```
calculator-collection/
├── bruno.json
├── Add/
│   └── request.bru
├── Subtract/
│   └── request.bru
├── Multiply/
│   └── request.bru
└── Divide/
    └── request.bru
```

### 3. Customize Request (Add Operation)

```xml
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <Add xmlns="http://example.com/calculator">
      <intA>{{number1}}</intA>
      <intB>{{number2}}</intB>
    </Add>
  </soap:Body>
</soap:Envelope>
```

### 4. Configure Environment

```json
{
  "number1": "10",
  "number2": "5",
  "serviceUrl": "https://api.example.com/calculator/soap"
}
```

### 5. Execute Request

Click **Send** and view the SOAP response in the Response tab.

## Related Documentation

- [SOAP Request Guide](../send-requests/soap/soap-request) - Learn how to manually create and configure SOAP requests
- [Bruno CLI Import](../bru-cli/import) - Complete CLI import command reference
- [Converters Overview](./overview) - Information about other import formats
- [Variables](../variables/overview) - Using variables in SOAP requests
- [Environments](../variables/environments) - Managing multiple environments for SOAP services

## Troubleshooting

### WSDL Parsing Errors

If you encounter parsing errors:

1. **Validate your WSDL**: Use an online WSDL validator to check for syntax errors
2. **Check XML encoding**: Ensure the WSDL file uses UTF-8 encoding
3. **Verify namespaces**: All XML namespaces should be properly defined

### Missing Operations

If some operations are missing after import:

1. Check if the WSDL contains multiple services
2. Verify the port bindings are correctly defined
3. Look for any parsing warnings in the console

### Incorrect SOAP Envelope

If the generated SOAP envelope is not correct:

1. Check the WSDL schema definitions for the operation
2. Verify the SOAP binding style (document vs. rpc)
3. Manually adjust the envelope structure if needed

<Callout type="tip">
  For complex WSDL issues, consider reaching out to the Bruno community on [GitHub Discussions](https://github.com/usebruno/bruno/discussions) or [Discord](https://discord.com/invite/KgcZUncpjq).
</Callout>

